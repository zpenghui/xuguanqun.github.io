<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>重学JavaScript | xgq&#39;s blog</title>
    <meta name="description" content="">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="apple-mobile-web-app-title" content="MY APPLE TITLE">
  <meta name="theme-color" content="MY COLOR THEME">
  <meta name="msapplication-navbutton-color" content="MY COLOR THEME">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="coverage" content="WorldWide">
  <meta name="rating" content="general">
  <meta name="robots" content="index,follow">
  <meta name="googlebot" content="index,follow">
  <meta name="application-name" content="MY APP NAME">
  <meta name="msapplication-TileColor" content="MY COLOR THEME">
  <meta name="msapplication-config" content="/browserconfig.xml">
  <meta name="msapplication-square70x70logo" content="/favicon/ms-icon-70x70.png">
  <meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png">
  <meta name="msapplication-square150x150logo" content="/favicon/mstile-150x150.png">
  <meta name="msapplication-wide310x150logo" content="/favicon/ms-icon-310x310.png">
  <meta name="twitter:card" content="xuguanqun">
  <meta name="twitter:site" content="@xuguanqun">
  <meta property="fb:app_id" content="MY FACEBOOK APP ID">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="MY SITE NAME">
  <meta property="og:image:height" content="1200">
  <meta property="og:image:width" content="360">
  <meta property="og:image:type" content="image/png">
  <meta name="google-site-verification" content="MY VERIFICATION KEY">
  <meta name="msvalidate.01" content="MY VERIFICATION KEY">
  <meta name="yandex-verification" content="MY VERIFICATION KEY">
  <link rel="publisher" href="MY URL GOOGLE PLUS">
  <link rel="author" href="MY URL GOOGLE PLUS">
  <link rel="author" href="/humans.txt">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" href="/favicon/android-icon-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ff5733">
  <link rel="shortcut icon" href="/favicon/favicon.ico">
  <link rel="alternate" href="https://MY_DOMAIN.COM/" hreflang="zh">
  <link rel="preconnect" href="https://connect.facebook.net/">
  <link rel="preconnect" href="https://platform.twitter.com/">
  <link rel="preconnect" href="https://widget.sndcdn.com/">
  <link rel="preconnect" href="https://api-widget.soundcloud.com/">
  <link rel="preconnect" href="https://www.youtube.com/">
  <link rel="preconnect" href="https://scrimba.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/">
  <link rel="preconnect" href="https://c.disquscdn.com/">
  <link rel="preconnect" href="https://disqus.com/">
  <link rel="preconnect" href="https://www.google-analytics.com/">
  <link rel="preconnect" href="https://stats.g.doubleclick.net">
  <link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
    
    <link rel="preload" href="/assets/css/0.styles.395cd503.css" as="style"><link rel="preload" href="/assets/js/app.4e01488e.js" as="script"><link rel="preload" href="/assets/js/13.06b288ed.js" as="script"><link rel="preload" href="/assets/js/3.be68ce54.js" as="script"><link rel="preload" href="/assets/js/12.a2cf6586.js" as="script"><link rel="preload" href="/assets/js/11.b23c35cd.js" as="script"><link rel="preload" href="/assets/js/16.cc0be713.js" as="script"><link rel="preload" href="/assets/js/2.13afa1ee.js" as="script"><link rel="preload" href="/assets/js/5.0b9f2628.js" as="script"><link rel="preload" href="/assets/js/17.448d70ea.js" as="script"><link rel="preload" href="/assets/js/9.e77f29c9.js" as="script"><link rel="preload" href="/assets/js/7.960e42a4.js" as="script"><link rel="preload" href="/assets/js/6.f8153584.js" as="script"><link rel="preload" href="/assets/js/10.99ce920a.js" as="script"><link rel="preload" href="/assets/js/14.6e26b32d.js" as="script"><link rel="preload" href="/assets/js/4.3b6e6970.js" as="script"><link rel="prefetch" href="/assets/js/1.75264009.js"><link rel="prefetch" href="/assets/js/15.c1c1ec0e.js"><link rel="prefetch" href="/assets/js/18.9fb9cff2.js"><link rel="prefetch" href="/assets/js/19.10ec86c2.js"><link rel="prefetch" href="/assets/js/20.c43ea0f8.js"><link rel="prefetch" href="/assets/js/21.d9c0dcc5.js"><link rel="prefetch" href="/assets/js/22.1464f049.js"><link rel="prefetch" href="/assets/js/23.1673cf53.js"><link rel="prefetch" href="/assets/js/24.a138a543.js"><link rel="prefetch" href="/assets/js/25.f4d85ddc.js"><link rel="prefetch" href="/assets/js/26.f85b7fed.js"><link rel="prefetch" href="/assets/js/27.399a75b7.js"><link rel="prefetch" href="/assets/js/28.29257420.js"><link rel="prefetch" href="/assets/js/29.759ec459.js"><link rel="prefetch" href="/assets/js/30.875bb905.js"><link rel="prefetch" href="/assets/js/31.892c3273.js"><link rel="prefetch" href="/assets/js/32.574eafe4.js"><link rel="prefetch" href="/assets/js/33.1c7992ff.js"><link rel="prefetch" href="/assets/js/34.6ca509f5.js"><link rel="prefetch" href="/assets/js/35.467bc4ab.js"><link rel="prefetch" href="/assets/js/36.cdc58d10.js"><link rel="prefetch" href="/assets/js/37.b8a53b54.js"><link rel="prefetch" href="/assets/js/38.b8374dd8.js"><link rel="prefetch" href="/assets/js/39.97a8675d.js"><link rel="prefetch" href="/assets/js/40.a86867f6.js"><link rel="prefetch" href="/assets/js/41.dff52cf2.js"><link rel="prefetch" href="/assets/js/42.853bf881.js"><link rel="prefetch" href="/assets/js/43.1a1ac357.js">
    <link rel="stylesheet" href="/assets/css/0.styles.395cd503.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div itemscope="itemscope" itemtype="https://schema.org/WebPage" class="layout-main"><meta itemprop="name" content="xgq's blog"> <meta itemprop="alternateName" content="xgq's blog"> <meta itemprop="url" content=""> <nav aria-label="Navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement" class="container nav-mobile" style="display:none;"><span itemprop="headline" class="nav-mobile__title">导航</span> <ul class="nav-mobile__list"><li class="nav-mobile__item"><a href="/about/" itemprop="url" class="nav-mobile__link"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text">关于</span></a></li><li class="nav-mobile__item"><a href="/categories/" itemprop="url" class="nav-mobile__link"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text">类别</span></a></li><li class="nav-mobile__item"><a href="/categories/doc.html" itemprop="url" class="nav-mobile__link"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text">文档</span></a></li><li class="nav-mobile__item"><a href="/categories/post.html" itemprop="url" class="nav-mobile__link"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text">文章</span></a></li><li class="nav-mobile__item"><a href="/categories/translate.html" itemprop="url" class="nav-mobile__link"><span class="bullet no_bw bullet--primary bullet--undefined"></span> <span class="text">译文</span></a></li></ul></nav> <div class="container-fluid wrapper-body__nm"><header itemscope="itemscope" itemtype="https://schema.org/Organization" class="header"><!----> <div class="row header-top"><div class="column xs-33 sm-20"><div class="hamburguer header-top__hamburguer"><div class="hamburguer__wrapper"><span class="hamburguer__line"></span> <span class="hamburguer__line"></span> <span class="hamburguer__line"></span></div></div> <!----></div> <div class="column xs-33 sm-60"><div class="header__logo"><a href="/" itemprop="url" class="header-top-logo__link router-link-active"><img itemprop="logo" src="/xuguanqun-logo-2.png" srcset="/xuguanqun-logo-2.png 1x, /xuguanqun-logo-2@2x.png 2x" alt="xuguanqun's blog" style="width:50px;height:50px;"></a></div> <meta itemprop="name" content="xgq's blog"> <meta itemprop="sameAs" content="https://www.twitter.com/xuguanqun"><meta itemprop="sameAs" content="https://www.github.com/xuguanqun"></div> <div class="column xs-33 sm-20"><div class="search header-top__search"><!----> <span class="icon search__icon">search</span></div> <div class="switch-bw header-top__toggle"><span class="switch-bw__text">
    开启夜间模式
  </span> <label for="switch-bw" class="switch-bw__label"><input type="checkbox" id="switch-bw" name="switch-bw" aria-labelledby="switch-bw-text" class="switch-bw__input"> <span class="switch-bw__ball"></span> <span id="switch-bw-text" hidden="hidden">switch to black or white</span></label></div></div></div></header> <main id="main" itemscope="itemscope" itemtype="https://schema.org/Blog" class="main-page"><div><a href="#main" class="vue-skip-to">跳过</a> <div><div class="page page__full row justify-right"><article itemscope="itemscope" itemprop="blogPost" itemtype="https://schema.org/BlogPosting" class="column xs-100 page__full__box box-default"><meta itemprop="mainEntityOfPage" content="/posts/doc_js.html"> <header class="page-header page__full-header"><button type="button" class="ui-button reset-button back-button"><span class="icon back-button__icon icon--arrow">arrow</span> <span class="back-button__text">返回</span></button> <div class="page-header__meta"><time datetime="Sun Nov 22 2015 09:00:00 GMT+0800 (GMT+08:00)" itemprop="datePublished" class="text">
                
            </time> <meta itemprop="dateModified" content="currentPost.updated_at"> <!----></div> <h1 itemprop="name headline" class="page-header__title">重学JavaScript</h1> <div class="page-header-cat"><nav class="page-header-cat__nav"><ul class="page-header-cat__list"><li class="page-header-cat__item"><a href="/categories/doc.html" itemprop="keywords" class="page-header-cat__link meta-text">
                  文档
                </a></li></ul></nav></div> <div itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person" class="page-header__author"><strong>作者: </strong> <a href="/authors/xuguanqun.html" rel="author" itemprop="url" class="link link--filler-s-primary"><span itemprop="name">徐冠群</span></a></div></header> <!----> <!----> <section class="page-content page__full-content"><div class="row"><div class="column no-pad-l md-75 xl-67 post-content"><div class="post-content__box-player"><!----></div> <div class="post-content__excerpt"><!----></div> <div class="post-content__table-contents"><div class="table-contents"><h3 id="table-of-content" class="table-contents__title">目录</h3> <nav><ol class="table-contents__list"><li class="table-contents__item"><a href="#变量类型" title="变量类型" class="table-contents__link"><span>变量类型</span></a></li><!----><!----><li class="table-contents__item"><a href="#变量类型的判断与转换" title="变量类型的判断与转换" class="table-contents__link"><span>变量类型的判断与转换</span></a></li><!----><!----><li class="table-contents__item"><a href="#运算符" title="运算符" class="table-contents__link"><span>运算符</span></a></li><!----><!----><!----><li class="table-contents__item"><a href="#理解堆和栈" title="理解堆和栈" class="table-contents__link"><span>理解堆和栈</span></a></li><!----><!----><!----><li class="table-contents__item"><a href="#深浅拷贝" title="深浅拷贝" class="table-contents__link"><span>深浅拷贝</span></a></li><!----><!----><!----><!----><li class="table-contents__item"><a href="#原型链" title="原型链" class="table-contents__link"><span>原型链</span></a></li><!----><!----><!----><!----><li class="table-contents__item"><a href="#继承" title="继承" class="table-contents__link"><span>继承</span></a></li><!----><!----><!----><!----><!----><!----><li class="table-contents__item"><a href="#深入理解-instanceof" title="深入理解 instanceof" class="table-contents__link"><span>深入理解 instanceof</span></a></li><!----><!----><!----><!----><li class="table-contents__item"><a href="#深入理解-new" title="深入理解 new" class="table-contents__link"><span>深入理解 new</span></a></li><!----><!----><!----><li class="table-contents__item"><a href="#作用域" title="作用域" class="table-contents__link"><span>作用域</span></a></li><!----><!----><!----><!----><!----><!----><li class="table-contents__item"><a href="#闭包" title="闭包" class="table-contents__link"><span>闭包</span></a></li><!----><!----><!----><li class="table-contents__item"><a href="#垃圾回收" title="垃圾回收" class="table-contents__link"><span>垃圾回收</span></a></li><!----><!----><!----><!----><li class="table-contents__item"><a href="#this" title="this" class="table-contents__link"><span>this</span></a></li><!----><!----><!----><li class="table-contents__item"><a href="#apply、​call、bind" title="apply、​call、bind" class="table-contents__link"><span>apply、​call、bind</span></a></li><!----><!----><!----><!----><li class="table-contents__item"><a href="#​generator" title="​Generator" class="table-contents__link"><span>​Generator</span></a></li><li class="table-contents__item"><a href="#promise" title="Promise" class="table-contents__link"><span>Promise</span></a></li><li class="table-contents__item"><a href="#async、await" title="async、await" class="table-contents__link"><span>async、await</span></a></li><li class="table-contents__item"><a href="#定时器" title="定时器" class="table-contents__link"><span>定时器</span></a></li><li class="table-contents__item"><a href="#ajax" title="ajax" class="table-contents__link"><span>ajax</span></a></li><!----><!----><!----><li class="table-contents__item"><a href="#es6" title="ES6" class="table-contents__link"><span>ES6</span></a></li><!----></ol></nav></div></div> <div itemprop="articleBody"><h3 id="table-of-content" class="table-contents__title">正文</h3> <div class="content custom"><h1 id="重学javascript"><a href="#重学javascript" class="header-anchor">#</a> 重学JavaScript</h1> <h2 id="变量类型"><a href="#变量类型" class="header-anchor">#</a> 变量类型</h2> <p>在 <code>JavaScript</code> 中，总共有以下 <code>7</code> 种基本类型（原始类型）：</p> <ul><li>boolean</li> <li>number</li> <li>string</li> <li>null</li> <li>undefined</li> <li>Symbol（ES6）</li> <li>BigInt（ES10）</li></ul> <p>和 <code>1</code> 种引用类型：</p> <ul><li>object</li></ul> <p>引用类型又称对象类型，包含（Object、Array、function）</p> <h3 id="原始（primitive）类型"><a href="#原始（primitive）类型" class="header-anchor">#</a> 原始（Primitive）类型</h3> <p>原始类型，也称基本类型，存储的是值，存放在 <code>栈</code> 中，将一个变量赋值给另一个变量，拷贝的是值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span>
</code></pre></div><p>我们将 <code>a</code> 的值赋值给 <code>b</code> ，<code>a</code> 就直接就把值拷贝给它了，然后再去改变 <code>a</code> 的值，<code>b</code> 不会受到影响。</p> <div class="tip custom-block"><p class="custom-block-title">注意</p> <p>基本类型是无法调用函数的，比如 <code>undefined.toString()</code></p></div> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token boolean">true</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'true'   </span>
    <span class="token string">'str'</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'str'  </span>
    <span class="token number">NaN</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'NaN'  </span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">注意</p> <p>以上类型调用其实是js引擎在解析上面语句时，会把这三种基本类型解析为包装对象，而包装对象是引用类型可以调用 <code>Object.prototype</code> 上的方法。大概过程如下：</p></div> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token string">'xgq'</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">-</span><span class="token operator">&gt;</span>  <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'xgq'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">'xgq'</span> 
</code></pre></div><h4 id="boolean"><a href="#boolean" class="header-anchor">#</a> <strong>boolean</strong></h4> <p>布尔类型，包含两个值：<strong>true</strong> | <strong>false</strong></p> <h4 id="number"><a href="#number" class="header-anchor">#</a> <strong>number</strong></h4> <p>数字类型，使用双精度浮点型存储，就是其他语言中的<strong>double</strong>类型</p> <ol><li>在JS中能否表示的数字的绝对值范围是5e-324 ~ 1.7976931348623157e+308，这一点可以通过 <code>Number.MAX_VALUE</code> 和 <code>Number.MIN_VALUE</code> 来得到证实</li> <li>在JS中能够表示的最大安全整数的范围是：-9007199254740991 ~ 9007199254740991，这一点可以通过 <code>Number.MIN_SAFE_INTEGER</code> 和 <code>Number.MAX_SAFE_INTEGER</code> 来求证</li></ol> <div class="tip custom-block"><p class="custom-block-title">精度丢失问题</p> <p>精度丢失问题 <code>0.1+0.2 !== 0.3 //0.30000000000000004</code></p></div> <p>由于 <code>number</code> 类型使用双精度浮点型64 bit存储值，0.1和0.2转成二进制之后都是一个无限循环的数，根据IEEE 754定义的取舍规则，对尾数进行四舍五入之后，导致精度丢失。</p> <h4 id="string"><a href="#string" class="header-anchor">#</a> <strong>string</strong></h4> <p>字符串类型。</p> <h4 id="null"><a href="#null" class="header-anchor">#</a> <strong>null</strong></h4> <p><code>null</code> 的含义为“无”、“空”或“值未知”的特殊值。</p> <div class="tip custom-block"><p class="custom-block-title">类型判断bug</p> <p>类型判断错误  <code>typeof null //object</code></p></div> <p>在 JS 的最初版本中使用的是 32 位系统，为了性能考虑使用低位存储变量的类型信息， <code>000</code> 开头代表是对象，然而 <code>null</code> 表示为全零，所以将它错误的判断为 <code>object</code></p> <h4 id="undefined"><a href="#undefined" class="header-anchor">#</a> <strong>undefined</strong></h4> <p><code>undefined</code> 的含义是“未被赋值”，代表变量没有被赋予初始值。</p> <h4 id="symbol"><a href="#symbol" class="header-anchor">#</a> <strong>Symbol</strong></h4> <blockquote><p><code>Symbol</code> 是 <code>ES6</code> 中引入的新基本变量类型，表示独一无二的值</p></blockquote> <p>由于每一个 <code>Symbol</code> 都不相等，所以作为对象的属性名是一种很好的选择。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> symbolProp <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>symbolProp<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token string">'hello Symbol'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>注意</strong><br>
定义属性的时候只能将 <code>Symbol</code> 值放在方括号里面，否则属性的键名会当做字符串而不是 <code>Symbol</code> 值。<br>
同理，在访问 <code>Symbol</code> 属性的时候也不能通过点运算符去访问，点运算符后面总是字符串，不会读取 <code>Symbol</code> 值作为标识符所指代的值</p> <h4 id="bigint"><a href="#bigint" class="header-anchor">#</a> <strong>BigInt</strong></h4> <blockquote><p>BigInt是ES10加入的一个新数据类型，用于当整数值大于Number数据类型支持的范围时。这种数据类型允许我们安全地对大整数执行
算术操作，表示高分辨率的时间戳，使用大整数id，等等，而不需要使用库。</p></blockquote> <p>在 <code>JavaScript</code> 中，所有的数字都以双精度64位浮点格式表示，这会导致Number无法精确的表示非常大的整数，它会将非常大的整数四舍五入，从而失去精度，同时也会带来安全性问题。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">9007199254740992</span> <span class="token operator">===</span> <span class="token number">9007199254740993</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>创建 <code>BigInt</code> ，只需在数字后面加个 <code>n</code> 即可。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">9007199254740995n</span><span class="token punctuation">;</span>
</code></pre></div><p>也可使用 <code>BigInt()</code> 构造函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token string">&quot;9007199254740995&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 9007199254740995n</span>
</code></pre></div><h3 id="对象（object）类型"><a href="#对象（object）类型" class="header-anchor">#</a> 对象（Object）类型</h3> <p>对象类型存储的是地址（指针），存放在 <code>堆</code> 中，将一个对象类型赋值给另一个对象类型，拷贝的是地址。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
a<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{test: &quot;change&quot;}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{test: &quot;change&quot;}</span>
</code></pre></div><p>我们将 <code>a</code> 的值赋值给 <code>b</code> ，实际上是把 <code>a</code> 所链接的地址（指针）复制给 <code>b</code> ，所以当我们改变 <code>a</code> 的时候，实际上被改变的是那个地址中的值，由于 <code>b</code> 也链接着那个地址，所以当它被改变了，<code>b</code> 也就改变了。</p> <h4 id="object"><a href="#object" class="header-anchor">#</a> <strong>object</strong></h4> <p>对象是命名值的无序集合。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">c</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>该方法可以在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回这个对象。<br> <code>Object.defineProperty(obj, prop, descriptor)</code></p></blockquote> <h4 id="array"><a href="#array" class="header-anchor">#</a> <strong>array</strong></h4> <p>数组是带编号的有序集合。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
</code></pre></div><h4 id="function"><a href="#function" class="header-anchor">#</a> <strong>function</strong></h4> <p>函数是一个特殊的对象。声明函数通常有以下几种方式：</p> <ul><li>具名函数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'foo'</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>函数表达式</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'foo'</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>自执行函数（IIFE）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'匿名'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// or</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">注意</p> <p>因为 <code>IIFE</code> 只执行一次，所以加个名字有些画蛇添足。</p></div> <p><code>IIFE</code> 的各种写法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//按性能排序 （速度由快到慢）</span>
<span class="token keyword">void</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'IIFE'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">!</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'IIFE'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'IIFE'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'IIFE'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token operator">+</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'IIFE'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="变量类型的判断与转换"><a href="#变量类型的判断与转换" class="header-anchor">#</a> 变量类型的判断与转换</h2> <h3 id="类型判断"><a href="#类型判断" class="header-anchor">#</a> 类型判断</h3> <ul><li>typeof</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//用法</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">typeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//'number'</span>
<span class="token keyword">typeof</span> a<span class="token punctuation">;</span> <span class="token comment">//'number'</span>
</code></pre></div><p>typeof判断原始类型时，有一种数据类型是个例外：<code>null</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">//'object'</span>
</code></pre></div><p>而用 <code>typeof</code> 去判断对象类型，除了函数其余都会判断为 <code>object</code>，所以 <code>typeof</code> 并不能准确判断出变量究竟是什么类型。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//'object'</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//'object'</span>
<span class="token keyword">typeof</span> console<span class="token punctuation">.</span>log<span class="token punctuation">;</span> <span class="token comment">//'function'</span>
</code></pre></div><ul><li>instanceof</li></ul> <p>如果我们想判断一个对象的正确类型，这时候可以考虑使用 <code>instanceof</code> ，因为内部机制是通过原型链来判断的.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'hello world'</span><span class="token punctuation">;</span>
str <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token keyword">var</span> str1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str1 <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>但是直接通过 <code>instanceof</code> 来判断原始类型却是不行的，但是我们可以通过改写 <code>Symbol.hasInstance</code> 来让 <code>instanceof</code> 能够判断原始类型。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">PrimitiveString</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'string'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello world'</span> <span class="token keyword">instanceof</span> <span class="token class-name">PrimitiveString</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>通过 <code>Symbol.hasInstance</code> 我们能自定义 <code>instanceof</code> 的内部判断逻辑，我们将代码改为用 <code>typeof</code> 进行原始类型的判断，所以能正确判断类型</p> <h3 id="类型转换"><a href="#类型转换" class="header-anchor">#</a> 类型转换</h3> <p>首先我们要知道，在 JS 中类型转换只有三种情况，分别是：</p> <ul><li><p>转换为布尔值</p></li> <li><p>转换为数字</p></li> <li><p>转换为字符串</p> <table><thead><tr><th style="text-align:center">原始值</th> <th style="text-align:center">转换目标</th> <th style="text-align:center">结果</th></tr></thead> <tbody><tr><td style="text-align:center">number</td> <td style="text-align:center">布尔值</td> <td style="text-align:center">除了0、-0、NaN，都为true</td></tr> <tr><td style="text-align:center">string</td> <td style="text-align:center">布尔值</td> <td style="text-align:center">除了空字符串，都为true</td></tr> <tr><td style="text-align:center">undefined、null</td> <td style="text-align:center">布尔值</td> <td style="text-align:center">false</td></tr> <tr><td style="text-align:center">引用类型</td> <td style="text-align:center">布尔值</td> <td style="text-align:center">true</td></tr> <tr><td style="text-align:center">number</td> <td style="text-align:center">字符串</td> <td style="text-align:center">1=&gt;'1'</td></tr> <tr><td style="text-align:center">Boolean、函数、Symbol</td> <td style="text-align:center">字符串</td> <td style="text-align:center">'true'</td></tr> <tr><td style="text-align:center">数组</td> <td style="text-align:center">字符串</td> <td style="text-align:center">[1,2]=&gt;'1,2'</td></tr> <tr><td style="text-align:center">对象</td> <td style="text-align:center">字符串</td> <td style="text-align:center">'[object Object]'</td></tr> <tr><td style="text-align:center">string</td> <td style="text-align:center">数字</td> <td style="text-align:center">'1'=&gt;1，'a'=&gt;NaN</td></tr> <tr><td style="text-align:center">数组</td> <td style="text-align:center">数字</td> <td style="text-align:center">空数字为0，存在一个元素且为数组转数字，其他情况NaN</td></tr> <tr><td style="text-align:center">null</td> <td style="text-align:center">数字</td> <td style="text-align:center">0</td></tr> <tr><td style="text-align:center">除了数组的引用类型</td> <td style="text-align:center">数字</td> <td style="text-align:center">NaN</td></tr> <tr><td style="text-align:center">Symbol</td> <td style="text-align:center">数字</td> <td style="text-align:center">抛错</td></tr></tbody></table></li></ul> <h4 id="转boolean"><a href="#转boolean" class="header-anchor">#</a> 转Boolean</h4> <p>在条件判断时，除了 <code>undefined，</code> <code>null</code>， <code>false</code>， <code>NaN</code>， <code>''</code>， <code>0</code>， <code>-0</code>，其他所有值都转为 <code>true</code>，包括所有对象。</p> <h4 id="对象转原始类型"><a href="#对象转原始类型" class="header-anchor">#</a> 对象转原始类型</h4> <p>对象在转换类型的时候，会调用内置的 <code>[[ToPrimitive]]</code> 函数，对于该函数来说，算法逻辑一般来说如下：</p> <p>首先判断是否为原始类型，如果已经是原始类型了，那就不需要转换了
如果不是，则会调用 <code>x.toString()</code>，转换为基础类型的话就返回转换的值。不是字符串类型的话就先调用 <code>valueOf</code>，结果不是基础类型的话再调用 <code>toString</code>
调用 <code>x.valueOf()</code>，如果转换为基础类型，就返回转换的值
如果都没有返回原始类型，就会报错</p> <p>当然你也可以重写 <code>Symbol.toPrimitive</code> ，该方法在转原始类型时调用优先级最高。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'1'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token number">1</span> <span class="token operator">+</span> a<span class="token punctuation">;</span> <span class="token comment">// =&gt; 3</span>
</code></pre></div><h2 id="运算符"><a href="#运算符" class="header-anchor">#</a> 运算符</h2> <h3 id="四则运算符"><a href="#四则运算符" class="header-anchor">#</a> 四则运算符</h3> <blockquote><p><code>+ - * /</code></p></blockquote> <p>加法运算符不同于其他几个运算符，它有以下几个特点：</p> <ul><li>运算中其中一方为字符串，那么就会把另一方也转换为字符串</li> <li>如果一方不是字符串或者数字，那么会将它转换为数字或者字符串</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">+</span> <span class="token string">'1'</span> <span class="token punctuation">;</span><span class="token comment">// '11'</span>
<span class="token boolean">true</span> <span class="token operator">+</span> <span class="token boolean">true</span> <span class="token punctuation">;</span><span class="token comment">// 2</span>
<span class="token number">4</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token comment">// &quot;41,2,3&quot;</span>
</code></pre></div><p>如果你对于答案有疑问的话，请看解析：</p> <p>对于第一行代码来说，触发特点一，所以将数字 1 转换为字符串，得到结果 '11'<br>
对于第二行代码来说，触发特点二，所以将 <code>true</code> 转为数字 1<br>
对于第三行代码来说，触发特点二，所以将数组通过 <code>toString</code> 转为字符串 1,2,3，得到结果 41,2,3<br>
另外对于加法还需要注意这个表达式 <code>'a' + + 'b'</code></p> <p><code>'a' + + 'b' // -&gt; &quot;aNaN&quot;</code><br>
因为 + 'b' 等于 <code>NaN</code>，所以结果为 &quot;aNaN&quot;，你可能也会在一些代码中看到过 + '1' 的形式来快速获取 <code>number</code> 类型。</p> <p>那么对于除了加法的运算符来说，只要其中一方是数字，那么另一方就会被转为数字</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">4</span> <span class="token operator">*</span> <span class="token string">'3'</span> <span class="token punctuation">;</span><span class="token comment">// 12</span>
<span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token comment">// 0</span>
<span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token comment">// NaN</span>
</code></pre></div><h3 id="比较和逻辑运算符"><a href="#比较和逻辑运算符" class="header-anchor">#</a> 比较和逻辑运算符</h3> <p>比较和逻辑运算符用于测试 <code>true</code> 或 <code>false</code></p> <h4 id="比较运算符"><a href="#比较运算符" class="header-anchor">#</a> 比较运算符</h4> <blockquote><p><code>&gt; &lt; &gt;= &lt;= == === != !==</code></p></blockquote> <p>如果是对象，就通过 <code>toPrimitive</code> 转换对象<br>
如果是字符串，就通过 <code>unicode</code> 字符索引来比较</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'1'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
a <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">;</span><span class="token comment">// true</span>
</code></pre></div><p>在以上代码中，因为 a 是对象，所以会通过 <code>valueOf</code> 转换为原始类型再比较值。</p> <h4 id="逻辑运算符"><a href="#逻辑运算符" class="header-anchor">#</a> 逻辑运算符</h4> <blockquote><p><code>&amp;&amp; || !</code></p></blockquote> <table><thead><tr><th style="text-align:center">运算符</th> <th style="text-align:center">语法</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">逻辑与，AND（&amp;&amp;）</td> <td style="text-align:center">expr1 &amp;&amp; expr2</td> <td style="text-align:center">若 expr1 可转换为 true，则返回 expr2；否则，返回 expr1。</td></tr> <tr><td style="text-align:center">逻辑或，OR（||）</td> <td style="text-align:center">expr1 || expr2</td> <td style="text-align:center">若 expr1 可转换为 true，则返回 expr1；否则，返回 expr2。</td></tr> <tr><td style="text-align:center">逻辑非，NOT（!）</td> <td style="text-align:center">!expr</td> <td style="text-align:center">若 expr 可转换为 true，则返回 false；否则，返回 true。</td></tr></tbody></table> <h3 id="位运算符"><a href="#位运算符" class="header-anchor">#</a> 位运算符</h3> <blockquote><p><code>| &amp; ~ ^</code></p></blockquote> <h4 id="位运算符的应用"><a href="#位运算符的应用" class="header-anchor">#</a> 位运算符的应用</h4> <ul><li>判断奇偶数</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>num <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">===</span> <span class="token number">1</span> <span class="token punctuation">;</span><span class="token comment">// num 为奇数</span>
num <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">===</span> <span class="token number">0</span> <span class="token punctuation">;</span><span class="token comment">// num 为偶数</span>
</code></pre></div><p>因为二进制的奇数最低位是1，偶数最低位是0，&amp; 1运算后可以判断奇偶，速度与 <code>%2判断奇偶数</code> 差不多。</p> <ul><li>取整</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">~</span><span class="token operator">~</span><span class="token number">3.14159</span> <span class="token punctuation">;</span><span class="token comment">// 3</span>
<span class="token number">3.14159</span> <span class="token operator">&gt;&gt;</span> <span class="token number">0</span> <span class="token punctuation">;</span><span class="token comment">// 3</span>
<span class="token number">3.14159</span> <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span> <span class="token punctuation">;</span><span class="token comment">// 3</span>
<span class="token number">3.14159</span> <span class="token operator">|</span> <span class="token number">0</span> <span class="token punctuation">;</span><span class="token comment">// 3</span>
</code></pre></div><p>'&gt;&gt;&gt;'不用于对负数取整,其他都可以</p> <ul><li>比较值是否相等</li></ul> <p><code>^</code> 也会将字符串类型的数字转换成数字后进行运算，相当于 <code>==</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">^</span> <span class="token number">1</span> <span class="token punctuation">;</span> <span class="token comment">//0</span>
</code></pre></div><p>与 <code>==</code> 相比，<code>^</code> 的效率更高一些，但可读性差一些。</p> <ul><li>变量值为数字时，完成值的交换</li></ul> <p>a ^= b 等同于 a = a ^ b</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">2</span>
a <span class="token operator">^=</span> b
b <span class="token operator">^=</span> a
a <span class="token operator">^=</span> b
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre></div><ul><li>RGB值和16进制颜色值的转换</li></ul> <p>16进制转RGB</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">hexToRGB</span><span class="token punctuation">(</span><span class="token parameter">hex</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> hex <span class="token operator">=</span> hex<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;0x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        r <span class="token operator">=</span> hex <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">,</span>
        g <span class="token operator">=</span> hex <span class="token operator">&gt;&gt;</span> <span class="token number">8</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">,</span>
        b <span class="token operator">=</span> hex <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;rgb(&quot;</span><span class="token operator">+</span>r<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>g<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>b<span class="token operator">+</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>RGB转16进制</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">RGBToHex</span><span class="token punctuation">(</span><span class="token parameter">rgb</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> rgbArr <span class="token operator">=</span> rgb<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/[^\d]+/</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        color <span class="token operator">=</span> rgbArr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span> <span class="token operator">|</span> rgbArr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span> <span class="token operator">|</span> rgbArr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;#&quot;</span><span class="token operator">+</span>color<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="理解堆和栈"><a href="#理解堆和栈" class="header-anchor">#</a> 理解堆和栈</h2> <p>想真正理解<strong>基本类型</strong>和<strong>对象类型</strong>的区别，就要先理解 <code>堆</code> 和 <code>栈</code> 这两个概念。</p> <h3 id="栈"><a href="#栈" class="header-anchor">#</a> 栈</h3> <ul><li>存储的值大小固定</li> <li>空间较小</li> <li>可以直接操作其保存的变量，运行效率高</li> <li>由系统自动分配存储空间</li></ul> <p>当我们声明了一个变量，并储存基本类型时，就会直接将值存放在栈中。但是如果储存的是对象类型时，它不会储存整个对象，而是储存对象的地址，通过地址来找到数据内容。</p> <p><img src="data:image/png;base64,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" alt="栈"></p> <h3 id="堆"><a href="#堆" class="header-anchor">#</a> 堆</h3> <ul><li>存储的值大小不定，可动态调整</li> <li>空间较大，运行效率低</li> <li>无法直接操作其内部存储，使用引用地址读取</li> <li>通过代码进行分配空间</li></ul> <p><img src="data:image/png;base64,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" alt="堆"></p> <h3 id="区分原始类型和对象类型的是什么"><a href="#区分原始类型和对象类型的是什么" class="header-anchor">#</a> 区分原始类型和对象类型的是什么</h3> <ol><li><strong>区别1：引用方式</strong></li></ol> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>原始类型的值存放在 <code>栈</code> 中，而对象类型存放在 <code>堆</code> 中。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'str'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bool <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">func</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><img src="/assets/img/dz1.e565b114.png" alt="栈和堆"></p> <ol start="2"><li><strong>区别2：可变性</strong></li></ol> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>原始类型的值不可变，而对象类型的值可变。</p></div> <p>在 <code>ECMAScript</code> 标准中，原始类型为：<code>primitive values</code> ，值的本身是不会被改变的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'n'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'xgq'</span>
</code></pre></div><p>可以看到我们对 <code>str</code> 进行各种字符串操作，结果还是没有改变 <code>str</code> 的值。</p> <p>注意以下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
str <span class="token operator">+=</span> <span class="token string">' nb'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'xgq nb'</span>
</code></pre></div><p>上述代码看似改变了 <code>str</code> 的值，其实从内存上进行理解则不然。</p> <p>当我们声明一个变量 <code>str</code>，并赋值为一个字符串：<code>xgq</code>，<code>JavaScript</code> 就会在栈中开辟出一个<strong>固定大小</strong>的空间，用于存放 <code>xgq</code> 这个字符串。</p> <blockquote><p>栈中的内存大小是固定的，也就意味着栈里的变量是无法改变大小的</p></blockquote> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALkAAABSCAYAAAAILnUdAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAQwSURBVHhe7ZqxTuNAEIZ5pWv9FNfmBVzzAjwD1omejgJRW7TpENU1SEimSHEFQopERBFFQtqbMU68SRxwco49zH2f9Cv2ekOi5PNodsNJAHAOkoN7kBzcg+TgHiQH9yA5uAfJwT1IDu5BcnAPkoN7kBzc86XkJycnhJjIobSSHGBokBzcg+TgHiQH9yA5uAfJwT1IDu5BcnAPkoN7kBzcg+TgHiQ3RJGlISuqk4rVWJ6HfOMatAPJDfGp5KEIuR7n5TDsAZIboMizkKZpSJMkJPooJi9dbxSfir4XSG6IPE1WQheFtCcieJrov4qK/HoDJHIuN0Emk/C8PUhuhjykInNdtUVkLdm5iE2L8k8guRW0ZZFKrdV6rT0pZDweEPFVfip5e5DcBEXIyjZEBa+OdTcl0149kc+xale0X0+zkMs1+vL2ILkFpCVJtM+OF5lVxf64AbKoclPF9wXJDVBIxda2u2knRVktSGUxmklFZxtxP5DcELskLyu9tCpJIjdDeV2rfHkFWoDkhtiWXGRWwcvtw6hl2VyMwqcguSGWkpc/DlX74ln1W36RyXklth6zrdgeJDdEXcmbF5fam29VdfgSJAf3IDm4B8nBPUgO7jm65IRYyKG0knx69oMcEP3sfv3+SToIkhsNkncXJDcaJO8uSG40SN5dkNxokLy7ILnRIHl3QXKjQfLuguRGg+TdBcmNBsm7C5IbDZJ3FyQ3GiTvLkhuNINJPrkLT5OG8SPk6rmf1/pvJZ+NJ2Fx3XzNQoaS/Pb1Ltw2jB8jfb0Wkjdcs5BhJD8PT6/nDePHiLzW82nDePdxL/nsehzeq/cTXi7D29kozF+q84oP2WX84bKeL3NnDX+vrwwjeZSttkVvgJtwVR6fShX+U352JXOpyFvz28zpJ84lPwuLHbJuV3KVfBLeB5Z7mcElF0nvo3ZChb1/rI+nz+eV8NJbT27CVL7vWOA2c/qKb8kvLsPi4azxWqPkL5Mwv4jHhsvwkksebz5aiuVjOd7c0lw9/6kFlvnTr+b0GN+SS1TmdxF9tiFvs+RjaWfiseFiQnKJ7oBMV22KZFfLEY+3mdNj3Ete5mIU3rQVGY9WY83tio1WRWNHcumr50i+EzOSV5mNx6t2BMlbRNsUbTtUzmW70qYVoV3pM6NIWq3mteTT63FYRJUdyTezufBcHsv4XGWtt/+u5CaYlmPRc7+c0198S36huyvVmwlauWOpl9dksVlWdCSPs1V116qz3gD19qCOq8TrAreZ0098S/6NM7Tk+ybeYtwZJCdx7Ep+Gm4n9f53eS5VfxovTncFyUkcu5Jrfy0L0nn1JQtrW4yfBclJHMuSf7cgudEgeXc5uuSEWMihHP5MgG8CkoN7kBzcg+TgHiQH9yA5uAfJwT1IDu5BcnAPkoN7kBzcg+TgHiQH54TwFyptVFSJh4XdAAAAAElFTkSuQmCC" alt="基本类型"></p> <p>代码 <code>str += ' nb'</code> 执行了一次字符串拼接操作，实际上这是在栈中开辟出一个<strong>新的空间</strong>，用于存放拼接完成后的新值：<code>xgq nb</code>，然后将变量 <code>str</code> 指向这块新的空间。所以并不是改变原来那块空间里的值。</p> <p><img src="data:image/png;base64,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" alt="开辟空间"></p> <ol start="3"><li><strong>区别3：拷贝方式</strong></li></ol> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>当我们把一个变量的值拷贝给另一个变量，原始类型和引用类型对此的处理方式有很大区别。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
</code></pre></div><p>我们声明了一个变量 <code>a</code> ，用来存放基本类型：数字1，<code>JavaScript</code> 在栈中开辟出一块内存，用于存放 <code>a -&gt; 1</code> ，我们又声明了一个变量 <code>b</code>，让 <code>b</code> 等于 <code>a</code> ，此时 <code>JavaScript</code> 在栈中又开辟出一块新的内存，然后直接存放一个新的数字1: <code>b -&gt; 1</code>，所以当我们改变 <code>b</code> 的时候并不会影响 <code>a</code> 。</p> <p><img src="data:image/png;base64,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" alt="互不影响"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {test: &quot;xgq&quot;}</span>
</code></pre></div><p>我们声明了一个变量 <code>a</code>，用来存放引用类型，首先，<code>JavaScript</code> 在栈中开辟出一块内存，用于存放变量 <code>a</code>，然后在堆中开辟出一块内存，放置这个对象：<code>{test:'test}</code>，之后将这个堆的地址存放在 <code>a</code> 中，这样 <code>a</code> 可以通过地址去访问到真正的值。我们又声明了一个变量 <code>b</code> ，让 <code>b</code> 等于 <code>a</code> ，此时JavaScript会在栈中开辟出一块新内存，存放变量 <code>b</code> ，然后直接将 <code>a</code> 的地址给 <code>b</code> ，所以 <code>a</code> 和 <code>b</code> 其实共用的是同一个地址。</p> <p><img src="/assets/img/dz5.c623aa83.png" alt="引用方式"></p> <ol start="4"><li><strong>区别4：比较方式</strong></li></ol> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>当我们对两个值进行比较，原始类型与引用类型的比较规则并不相同。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'text'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>和上面的<strong>值拷贝</strong>一样，判断变量是否相等时，基本类型是判断两者的值是否相等，而对象类型则是判断两者是否指向同一个指针。</p> <ol start="5"><li><strong>值传递</strong></li></ol> <div class="tip custom-block"><p class="custom-block-title">注意</p> <p>ECMAScript 中所有的函数的参数都是按值传递的。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  value <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">change</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'xgq'</span>
</code></pre></div><p><code>name</code> 变量传入 <code>change</code> 函数， <code>change</code> 函数中对传入的参数进行了修改，但是没有修改 <code>name</code> 本身。</p> <p>这说明函数传递的是变量的值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'xgq'</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  value<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">change</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {name: &quot;change&quot;}</span>
</code></pre></div><p>上面这段代码怎么就改变了传入的值呢？</p> <p>其实 <code>obj</code> 这个引用对象，并不是直接传入函数中，而是新建一个副本，指向这个引用对象，在函数中也是通过这个副本对值进行修改，由于外面的 <code>obj</code> 和副本引用的都是同一个堆里的对象，所以才会看起来就像将整个引用传进去了。</p> <p>下面这个例子就能清楚的说明：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  value<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">;</span>
  obj <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'newName'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">change</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// change</span>
</code></pre></div><h2 id="深浅拷贝"><a href="#深浅拷贝" class="header-anchor">#</a> 深浅拷贝</h2> <p>把一个对象复制给另一个对象，我们称之为拷贝。</p> <div class="tip custom-block"><p class="custom-block-title">注意</p> <p>拷贝并非赋值</p></div> <p>先来看看赋值操作。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span><span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> clone <span class="token operator">=</span> obj<span class="token punctuation">;</span><span class="token comment">//直接赋值</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>clone<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>clone<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {test: &quot;change&quot;}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">===</span> clone<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>我们新建一个 <code>obj</code> ，作为例子，<code>clone</code> 通过赋值操作，但其实 <code>clone</code> 和 <code>obj</code> 引用的是同一个地址中的对象，所以我们一改变 <code>obj</code> ， <code>clone</code> 也跟着变，这并不算拷贝。</p> <h3 id="浅拷贝"><a href="#浅拷贝" class="header-anchor">#</a> 浅拷贝</h3> <p>拷贝是指从一个对象中，循环复制里面的属性给一个新对象，我们可以用 <code>Object.assign()</code> 来实现一个最简单的浅拷贝。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span><span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> copy <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>obj<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="测试用例"></p> <p>那为什么说它是浅拷贝呢？我们更改 obj 的值试试。</p> <div class="language-js extra-class"><pre class="language-js"><code>obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">;</span>
<span class="token comment">//再打印出 copy 看看</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="测试用例"></p> <p>可以看到，变量 <code>a</code> 没有发生变化，而变量 <code>b</code> 里却发生了变化。之前堆栈中讲了，基本类型在栈中，拷贝时拷贝的是<code>值</code>，而对象类型拷贝时拷贝的是<code>地址</code>，所以只要地址链接的这个对象发生了变化，还是会影响到拷贝出来的新对象。</p> <blockquote><p><code>Object.assign()</code> 方法用于将所有可枚举属性的值从一个或多个源对象复制到目标对象。它将返回目标对象。</p></blockquote> <p>其实就是循环将一个对象的属性值拷贝给另一个对象，我们也可以自己写一个浅拷贝。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span><span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">{</span>
      newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token keyword">return</span> newObj
<span class="token punctuation">}</span>
<span class="token keyword">var</span> copy <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>浅拷贝只是拷贝到基本类型，并不能真正拷贝引用类型。</p> <h3 id="深拷贝"><a href="#深拷贝" class="header-anchor">#</a> 深拷贝</h3> <p>若是要把引用类型也全都拷贝，那就要在拷贝的时候进行判断：如果碰到基本类型则直接拷贝，如果碰到对象类型，那就展开再循环拷贝一遍里面的属性，无限重复这个动作直到拷贝完成。</p> <p>也就是使用递归函数来实现。</p> <ul><li>基础版</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//最简单的深拷贝</span>
<span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>当然，这是一个最简单的深拷贝，有很多的缺陷，比如说没有考虑到数组，我们修改一下代码，让它也能支持拷贝数组。</p> <ul><li>支持数组</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//深拷贝 支持数组</span>
<span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> newObj <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>支持循环引用</li></ul> <p>在对象的拷贝中，还有一种情况比较特殊，就是循环引用。
我们先来用上面的clone函数来拷贝一下下面这个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span><span class="token punctuation">{</span>
  a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span><span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span>xunhuan <span class="token operator">=</span> obj<span class="token punctuation">;</span><span class="token comment">//让obj的一个属性又链接到obj</span>
<span class="token keyword">var</span> copy <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/qkb3.e8d90d00.png" alt="爆栈"></p> <p>上面这个递归函数是不断的调用自身，循环进行属性的拷贝的，如果对象中的子属性又链接回来的话，会永远的循环下去，导致爆栈。</p> <p>如何解决这个问题呢？</p> <p>我们可以判断一下，如果是循环引用的话，就不要让它进入循环，任由它指向原先的地址。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//深拷贝 支持循环引用</span>
<span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> sign <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> newObj <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sign<span class="token punctuation">[</span>target<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> sign<span class="token punctuation">[</span>target<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        sign<span class="token punctuation">[</span>target<span class="token punctuation">]</span> <span class="token operator">=</span> newObj<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> sign<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/assets/img/qkb4.ce151d6e.png" alt="用例-循环引用"></p> <h3 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h3> <p>例子中的代码，我们只考虑了 <code>array</code> 和 <code>object</code> 这两种数据类型，其实还有更多的类型需要考虑，比如说 <code>Symbol</code> 、 <code>Date</code> 、 <code>Error</code> 。</p> <p>对于<strong>可遍历类型</strong>和<strong>不可遍历类型</strong>，处理的方式是不一样的。
另外，还得考虑性能问题，要对代码的实现方式进行性能优化。</p> <p>想要完全了解深拷贝，可以阅读 <code>lodash</code> 的拷贝实现源码，其中核心代码是 <strong>baseClone.js</strong></p> <ul><li><a href="https://github.com/lodash/lodash/blob/master/cloneDeep.js" target="_blank" rel="noopener noreferrer">lodash-cloneDeep.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="常用的一些方法"><a href="#常用的一些方法" class="header-anchor">#</a> 常用的一些方法</h3> <p><strong>浅拷贝</strong></p> <ul><li>Object.assign()</li> <li>ES6 解构赋值</li> <li>concat()</li> <li>slice()</li></ul> <p><strong>局限性</strong></p> <ul><li>JSON.stringify() + JSON.parse()</li></ul> <p>使用该方法很大程度上等同于深拷贝，但也有缺陷：无法拷贝函数和原型链的属性和方法。且速度不算快。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//示例代码</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span><span class="token string">'xgq'</span><span class="token punctuation">,</span>
  other<span class="token operator">:</span><span class="token punctuation">{</span>
    address<span class="token operator">:</span><span class="token string">'js'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token number">999</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>title<span class="token operator">:</span><span class="token string">'h1'</span><span class="token punctuation">,</span>value<span class="token operator">:</span><span class="token string">'hello'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">var</span> clone1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>obj<span class="token punctuation">)</span>
<span class="token keyword">var</span> clone2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token keyword">var</span> clone3 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>obj<span class="token punctuation">}</span>
<span class="token keyword">var</span> clone4 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> clone5 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="原型链"><a href="#原型链" class="header-anchor">#</a> 原型链</h2> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//构造函数</span>
<span class="token keyword">function</span><span class="token function"> Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token string">'test'</span><span class="token punctuation">;</span>
<span class="token comment">//创建实例</span>
<span class="token keyword">var</span> xgq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'xgq'</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//实例可以共享构造函数的属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xgq<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 'xgq'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xgq<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 22</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xgq<span class="token punctuation">.</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 'test'</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">构造函数与实例对象</p> <p>在 JavaScript 中，用 <code>new</code> 关键字来调用的函数，称为 <code>构造函数</code>，而通过 <code>new</code> 关键字调用 <code>构造函数</code> 所生成的对象叫做 <code>实例对象</code></p></div> <p>从以上代码我看可以看到，<code>Person</code> 是一个构造函数，<code>xgq</code> 则是一个实例对象，实例共享了构造函数中的 <code>name</code> 和 <code>age</code> 属性。而当我们去访问 <code>xgq.test</code> 时，也能访问到 <code>test</code> ，为什么呢？</p> <p>实际上，我们在使用 <code>new</code> 操作符时，会将 xgq 的 <code>__proto__</code> 属性链接到构造函数 <code>Person</code> 的 <code>prototype</code> 上。</p> <div class="language-js extra-class"><pre class="language-js"><code>xgq<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
</code></pre></div><p>当我们访问 <code>xgq.test</code> 首先会读取 <code>xgq</code> 这个对象的属性，如果没有这个属性则会通过 <code>__proto__</code> 找到这个对象的原型，也就是 <code>Person.prototype</code> 中寻找，于是找到了 <code>test</code> ，如果还是找不到，它会一层层往上查找，直到查找到该属性或者是到达最顶层 <code>Object</code> 的原型对象：<code>Object.prototype</code> 时才会停止。<br>
而一层层的查找方式就像一条铁链，一环接一环，所以我们把这个关系称之为原型链。</p> <h3 id="constructor"><a href="#constructor" class="header-anchor">#</a> constructor</h3> <p>我们先来单独理解一下 <code>constructor</code> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><code>person1</code> 与 <code>person2</code> 是 <code>Person</code> 对象的实例，他们的 <code>constructor</code> 指向创建它们的构造函数，即 <code>Person</code> 函数。</li> <li><code>Person</code> 是函数，但同时也是 <code>Function</code> 实例对象，它的 <code>constructor</code> 指向创建它的构造函数，即 <code>Function</code> 函数。</li> <li>至于 <code>Function</code> 函数，它是JS的内置对象，在第一点我们就已经知道它的构造函数是它自身，所以内部 <code>constructor</code> 属性指向自己。</li></ul> <h3 id="显式原型-prototype"><a href="#显式原型-prototype" class="header-anchor">#</a> 显式原型 <code>prototype</code></h3> <blockquote><p><code>prototype</code> 是一个显式原型属性，只有函数才拥有该属性</p></blockquote> <p>每个函数在创建后都会拥有一个名为 <code>prototype</code> 的属性，这个属性指向函数的原型对象。</p> <blockquote><p>通过 <code>Function.prototype.bind</code> 方法构造出来的函数是个例外，它没有 <code>prototype</code> 属性</p></blockquote> <p>声明一个函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'im a person'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt="对象"></p> <p>声明函数 <code>Person</code> 时，它自动创建了一个 <code>prototype</code> 指针（指向原型对象），而这个被指向的原型对象自动获得了一个 <code>constructor</code> （构造函数），并且 <code>constructor</code> 指向的就是 <code>Person</code> 。</p> <blockquote><p>一个函数的原型对象的构造函数就是这个函数本身</p></blockquote> <p><code>Person.prototype.constructor === Person</code></p> <p>上面的声明函数几乎等同于下面代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用Function构造器创建Function对象</span>
<span class="token keyword">var</span> Person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'...'</span><span class="token punctuation">)</span>
<span class="token comment">// 唯一的区别是：这种方式生成的函数是匿名函数[anonymous]，并且只在真正调用时才生成对象模型。</span>
</code></pre></div><blockquote><p>这也就是我们所说的：函数即对象</p></blockquote> <h3 id="隐式原型-proto"><a href="#隐式原型-proto" class="header-anchor">#</a> 隐式原型 <code>proto</code></h3> <blockquote><p>其实这个属性指向了 <code>[[prototype]]</code>，但是 <code>[[prototype]]</code> 是内部属性，我们并不能访问到，所以使用 <code>__proto__</code> 来访问。</p></blockquote> <p><code>__proto__</code> 指向了创建该对象的构造函数的显式原型。</p> <p><img src="/assets/img/3.22c5422c.jpg" alt="proto"></p> <p>我们发现这个 <code>__proto__</code> 指向的是 <code>Object.prototype</code>。</p> <p><code>__proto__</code> 这个属性很关键，它指向该对象所属的构造函数，使得对象可以通过该属性找到自己的所属。</p> <h2 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h2> <h3 id="原型链的问题"><a href="#原型链的问题" class="header-anchor">#</a> 原型链的问题</h3> <p>原型链并不是完美的，它包含以下两个问题：</p> <ul><li>当原型链中包含引用类型值的原型时，该引用类型值会被所有的实例共享</li> <li>在创建子类型时，不能向超类型的构造函数中传递参数</li></ul> <p>为了解决上述问题，我们很少会单独使用原型链，而使用继承则能弥补原型链的不足。</p> <h3 id="什么是继承"><a href="#什么是继承" class="header-anchor">#</a> 什么是继承</h3> <p>让一个普通的对象获得原本不属于它的属性和方法。</p> <p>那么如何让一个对象获得原本不属于它的东西呢？有三种途径：</p> <p>1.因为对象都是由 <code>constructor</code> 生成的，所以我们可以通过改变 <code>constructor</code> 来实现<br>
2.<code>constructor</code> 有一个关键的属性：<code>constructor.prototype</code>，所以改变原型也能达到目的。<br>
3.改变对象的属性，将要添加的内容复制过来。</p> <h3 id="借用构造函数"><a href="#借用构造函数" class="header-anchor">#</a> 借用构造函数</h3> <p>借用构造函数也叫经典继承</p> <blockquote><p>即在子类型构造函数的内部调用超类型构造函数</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">World</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Flower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">Word</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
f1<span class="token punctuation">.</span>color<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'grey'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> f2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;grey&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f2<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;]</span>
<span class="token comment">// 可见引用类型值是独立的</span>
</code></pre></div><p>借用构造函数，我们解决了原型链的两大问题</p> <ul><li>保证了原型链中引用类型值的独立</li> <li>子类型创建时也能向父类型传参</li></ul> <p>这个方法的不足之处在于：构造函数的方法都是在函数中定义，函数无法复用，而超类型中定义的方法，对子类型而言是不可见的。</p> <h3 id="组合继承"><a href="#组合继承" class="header-anchor">#</a> 组合继承</h3> <p>组合继承也叫伪经典继承</p> <blockquote><p>使用原型链实现对原型属性和方法的继承，通过借用构造函数来实现对实例属性的继承</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">World</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">World</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">Flower</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">World</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//继承实例属性，第一次调用World()</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Flower</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">World</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//继承父类方法,第二次调用World()</span>
<span class="token class-name">Flower</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getType</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> rose <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flower</span><span class="token punctuation">(</span><span class="token string">'rose'</span><span class="token punctuation">,</span><span class="token string">'flower'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
rose<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rose<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;, &quot;yellow&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rose<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rose</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rose<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// flower</span>
</code></pre></div><p>组合继承避免了原型链和借用构造函数的缺点，而且 <code>instansof</code> 和 <code>isPrototypeOf()</code> 也能识别基于组合继承创建的对象，所以它成为了 <code>JavaScript</code> 中最常用的继承方式。</p> <h3 id="原型继承"><a href="#原型继承" class="header-anchor">#</a> 原型继承</h3> <p>待补充</p> <h3 id="寄生继承"><a href="#寄生继承" class="header-anchor">#</a> 寄生继承</h3> <p>待补充</p> <h2 id="深入理解-instanceof"><a href="#深入理解-instanceof" class="header-anchor">#</a> 深入理解 instanceof</h2> <h3 id="作用"><a href="#作用" class="header-anchor">#</a> 作用</h3> <p><code>instanceof</code> 的作用是检测某个对象是否属于某个构造函数。利用这个特性，我们能进行对象类型的判断。比如：<code>[] instanceof Array</code> ，我们通过判断一个数组是否属于 <code>Array</code> 这个对象，就能判断出它是否是个数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//基本用法</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre></div><p>判断实例与原型的关系</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>student <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre></div><p>也可以检测父类型</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> p<span class="token punctuation">;</span> <span class="token comment">//继承原型</span>
<span class="token keyword">var</span> xgq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xgq <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xgq <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre></div><h3 id="改写"><a href="#改写" class="header-anchor">#</a> 改写</h3> <p><code>instanceof</code> 可以进行改写，通过修改该方法的判断逻辑，我们可以得到我们想要的判断结果。</p> <blockquote><p><code>Symbol.hasInstance</code> 用于判断某对象是否为某构造器的实例。因此你可以用它自定义 <code>instanceof</code> 操作符在某个类上的行为。—— MDN</p></blockquote> <p>以下为 <code>MDN</code> 示例代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyArray</span> <span class="token punctuation">{</span>  
  <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">MyArray</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>通过修改 <code>Symbol.hasInstance</code> 属性就可以修改 <code>instanceof</code> 的判断逻辑。我们可以自己新建一个构造函数，自己写里面的判断逻辑，得到我们想要得到的判断结果。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">isXGQ</span> <span class="token punctuation">{</span>  
  <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> str <span class="token operator">===</span> <span class="token string">'xgq'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'xgq'</span> <span class="token keyword">instanceof</span> <span class="token class-name">isXGQ</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <p>我们不难看出， <code>instanceof</code> 实际上就是通过原型链向上进行查找，遍历整个原型链来查找出他们之间的关联。而判断实例与原型的关系，我们就要用到这两个属性： <code>__proto__</code> 与 <code>prototype</code> ，通过 <code>proto</code> 这个属性不断的向上进行查找，和 <code>prototype</code> 进行比对来实现。</p> <h3 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myInstanceof</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__
  right <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> left <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">===</span> left<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="深入理解-new"><a href="#深入理解-new" class="header-anchor">#</a> 深入理解 new</h2> <h3 id="作用-2"><a href="#作用-2" class="header-anchor">#</a> 作用</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//构造函数</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//创建实例</span>
<span class="token keyword">var</span> xgq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'xgq'</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>new</code> 操作符是js内置的、用于创建一个实例对象的标识符。创建实例后，实例会获得构造函数中的属性和方法。</p> <p>那 <code>new</code> 的原理是什么呢，<code>new</code> 在背后做了什么。</p> <h3 id="原理-2"><a href="#原理-2" class="header-anchor">#</a> 原理</h3> <blockquote><p>原理解释来自：MDN</p></blockquote> <p>1.创建一个空的简单 <code>JavaScript对象</code>，即：<code>{}</code><br>
2.链接该对象（即设置该对象的构造函数）到另一个对象<br>
3.将步骤1新创建的对象作为 <code>this</code> 的上下文<br>
4.如果该函数没有返回对象，则返回 <code>this</code></p> <p>按照上面的原理解释，我们可以试着实现 <code>new</code> 操作符。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/*
下面试着写写 new 操作符都干了什么
我们现在要让 obj 继承 Person 这个构造函数，我们应该让对象的 proto 等于构造函数的 prototype
*/</span>
obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
<span class="token comment">//把 obj 打印出来看看，已经从 {} 变为 Person{} 了</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Person {}</span>
<span class="token comment">//然后我们要把参数也传进去</span>
<span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'xgq'</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//我们再看看 obj ，已经传入了参数并将 obj 作为 this 的上下文</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Person {name: &quot;xgq&quot;, age: 22}</span>
</code></pre></div><blockquote><p>apply() 方法调用一个具有给定this值的函数，以及作为一个数组（或类似数组对象）提供的参数。—— MDN</p></blockquote> <p>当然，这只是根据其原理做出的一个简单的实现，我们接着完善一下代码，来写一个 <code>new</code> 的真正实现。</p> <h3 id="实现-2"><a href="#实现-2" class="header-anchor">#</a> 实现</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">Con<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token class-name">Con</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">Con</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token operator">?</span> result <span class="token operator">:</span> obj
<span class="token punctuation">}</span>
# 测试
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> xgq <span class="token operator">=</span> <span class="token function">create</span> <span class="token punctuation">(</span>Person<span class="token punctuation">,</span><span class="token string">'xgq'</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Person {name: &quot;xgq&quot;, age: 22}</span>
</code></pre></div><h2 id="作用域"><a href="#作用域" class="header-anchor">#</a> 作用域</h2> <p>首先介绍三个概念：</p> <ul><li><strong>引擎</strong>：从头到尾负责整个 JavaScript程序的编译以及执行过程。</li> <li><strong>编译器</strong>：负责语法分析及代码生成工作。</li> <li><strong>作用域</strong>：负责收集并维护由所有声明标识符组成的一系列查询，用非常严格的规则，确定当前执行的代码对这些标识符的访问权限。</li></ul> <h3 id="编译原理"><a href="#编译原理" class="header-anchor">#</a> 编译原理</h3> <p><code>JavaScript</code> 是一门编译语言，但与传统的编译语言不同，它不是提前编译的，编译的结果也不能在分布式系统中进行移植，程序中的一段代码在执行之前会经历三个步骤，统称为 <code>编译</code>。</p> <ol><li>分词/词法分析</li></ol> <p>我们的代码对<code>JavaScript</code>引擎来说就是一段冗长的字符串，这个过程会将你写的代码分解成有意义的代码块。例如： <code>var a = 2</code> --&gt; <code>var 、a 、 = 、 2</code>，空格是否会被当做词法单元，取决于空格在这门语言中是否具有意义。</p> <ol start="2"><li>解析/语法分析</li></ol> <p>这个过程会将词法单元流（数组）转换成由程序语法结构树。称为 <code>“抽象语法树”</code> （AST） 。</p> <ol start="3"><li>代码生成</li></ol> <p>最后将AST转换为可执行代码，这个过程与语言、目标平台等息息相关。到这一步， <code>var a = 2</code> 这段代码才会真正的做出行为：创建一个变量，命名为 <code>a</code>（包括分配内存等行为），并将 <code>2</code> 这个值储存在 <code>a</code> 中。</p> <h3 id="编译器"><a href="#编译器" class="header-anchor">#</a> 编译器</h3> <p>代码生成后，编译器就起到了至关重要的作用。这里最重要的两个概念是 <code>LHS</code> 和 <code>RHS</code> 。</p> <p>一个不严谨的解释：当变量出现在赋值操作的左侧时进行 <code>LHS</code> 查询，出现在右侧时进行 <code>RHS</code> 查询。</p> <blockquote><p>LHS查询和RHS查询的含义是&quot;赋值操作的左侧和右侧&quot;，并不一定是意味着是&quot; = 赋值操作符的左侧和右侧&quot;。赋值操作还有其他几种形式，因此在概念上最好将其理解为&quot;赋值操作的目标是谁（LHS）&quot;以及&quot;谁是赋值操作的源头（RHS）&quot;。——《你不知道的JavaScript》</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>LHS</li></ul> <p>对于 <code>var b = a</code> 这段代码，JavaScript引擎会为变量b进行 <code>LHS</code> 查询，为变量 <code>b</code> 找到 <code>a</code> 进行赋值。</p> <p>如果理解不了的话，可以把 LHS 理解为写入内存。</p> <p>执行的 <code>LHS</code> 查找：<code>c=, a=2(隐式变量分配), b=</code></p> <ul><li>RHS</li></ul> <p>对于 <code>var c = foo(2)</code>，变量 <code>c</code> 进行一次 LHS 查询，foo函数中则是 <code>RHS</code> ，找出 <code>a</code> 。</p> <p>如果理解不了的话，可以把 RHS 理解为从内存中读取。</p> <p>执行的 <code>RHS</code> 查找：<code>读取foo,= a, a ,b</code></p> <h3 id="全局作用域"><a href="#全局作用域" class="header-anchor">#</a> 全局作用域</h3> <p>声明在任何函数之外的顶层作用域中的变量，就是全局变量。</p> <p>可以通过 <code>window</code> 这个关键字进行访问。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">666</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 666</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 666</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>当然，也可以用 <code>window</code> 这个关键字声明，而且用这种方式，可以在代码的任何位置进行声明。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  window<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">666</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 666</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 666</span>
</code></pre></div><h3 id="词法作用域"><a href="#词法作用域" class="header-anchor">#</a> 词法作用域</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> a <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">bar</span><span class="token punctuation">(</span>b<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2,4,12</span>
</code></pre></div><p>这个例子中，有三个逐级嵌套的作用域。词法作用域的意思就是从代码书写时，函数与变量声明的位置就已经决定了它们各自的作用域，所以词法作用域是静态的作用域。</p> <p><img src="/assets/img/zyy1.67db30a3.png" alt="作用域"></p> <p>我们可以看到最里面的 <code>bar</code> 中除了接收到参数 <code>c</code> 以外，并没有 <code>a</code> 与 <code>b</code> 这两个变量，但是它依然能访问到它们。</p> <p>它们的查找规则为向外查找， <code>bar</code> 中没有a和b这两个变量，那就往上找，包裹着它们的是 <code>foo</code> 函数，所以就在 <code>foo</code> 函数里查找这两个变量，找到一个 <code>b</code> 变量，但 <code>b</code> 是由 <code>a</code> 进行计算获得的，那就再往上找，<code>foo</code> 的外面就是全局作用域了，代码也就是在这里将 <code>2</code> 作为 <code>a</code> 传入 <code>foo</code> 的。</p> <h3 id="函数作用域和块作用域"><a href="#函数作用域和块作用域" class="header-anchor">#</a> 函数作用域和块作用域</h3> <p><code>JavaScript</code> 通过函数来管理作用域，在函数内部声明的变量只能在函数内部进行使用。（有一个例外，那就是闭包）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//函数作用域</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> xgq <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xgq<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Uncaught ReferenceError: xgq is not defined</span>
</code></pre></div><p>我们在函数中声明一个变量 <code>xgq</code>，在函数外进行访问，就会报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//块级作用域</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> xgq <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xgq<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'xgq'</span>
</code></pre></div><p>而块级作用域则无区别。</p> <h3 id="变量提升"><a href="#变量提升" class="header-anchor">#</a> 变量提升</h3> <p>我们写代码是一行一行写的，所以难免在直觉上会认为代码是一行一行执行的，但实际上这并不完全正确。</p> <p>考虑两段代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//例一</span>
a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你可能会以为是 <code>undefined</code> ，因为 <code>var a</code> 在 <code>a = 2</code> 的后面，认为变量被重新赋值了，但其实真正的输出结果是 <code>2</code> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//例二</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><p>而这个例子则不像上个例子一样输出 <code>2</code> ，而是 <code>undefined</code> 。</p> <p>要解释这个问题，又得回到 <code>JavaScript</code> 的编译器中，变量和函数在内的所有声明，都会在代码被执行前被处理。</p> <p>当你看到 <code>var a = 2</code> 时，可能会认为这是一个声明，但 <code>JavaScript</code> 实际上会认为这个是两个声明：<code>var a</code> 和 <code>a = 2</code> 。也就是先声明变量，再对变量进行赋值。</p> <blockquote><p>这是两个步骤！第一个定义声明是在编译阶段进行的。第二个赋值声明会被留在原地等待执行阶段。</p></blockquote> <p><strong>我们再来重新思考一下</strong></p> <p>第一个例子中，首先编译器会找到声明操作，也就是 <code>var a</code> ，先执行，然后接着执行代码，也就是 <code>a = 2</code> ，最后执行 <code>console.log</code> 把 <code>a</code> 打印出来，所以结果是 <code>2</code> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//例一 正确的执行顺序</span>
<span class="token keyword">var</span> a<span class="token punctuation">;</span><span class="token comment">//提升到了头部</span>
a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>就好像是把声明操作 <code>var 变量</code> ，提到了代码的最前面，先执行掉。</strong></p> <p>第二个例子中，编译器还是先找声明操作，找到 <code>var a</code> ，同样的，提升到代码的头部先执行，然后接着执行代码，<code>console.log(a)</code> ，最后执行 <code>a = 2</code> ，所以结果是 <code>undefined</code> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//例二 正确的执行顺序</span>
<span class="token keyword">var</span> a<span class="token punctuation">;</span><span class="token comment">//提升到了头部</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre></div><p>所以，这种把声明操作提升到代码的头部，先完成执行操作的情况，我们称为<strong>变量提升</strong>。</p> <p><strong>为什么存在变量提升</strong></p> <p>变量提升其实是为了函数而存在的，看个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'im second'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这段代码先声明了一个 <code>first</code> 函数，在里面调用了 <code>second</code> ，如果代码是一行一行执行的，那么在声明 <code>first</code> 函数的时候，<code>second</code> 函数连声明都还没声明，都不存在，那又怎么调用的到呢？</p> <p>不仅变量会提升，函数也会提示，且函数优先于变量被提升。</p> <p>上面的例子，<code>first</code> 和 <code>second</code> 被提升到头部，先声明完成，然后调用 <code>first</code> 函数，自然就能查找到 <code>second</code> 了。</p> <h2 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h2> <div class="tip custom-block"><p class="custom-block-title">《你不知道的JavaScript》</p> <p>当函数可以记住并访问所在的词法作用域时，就产生了闭包，即使函数是在当前词法作用域之外执行。</p></div> <p><strong>闭包的作用</strong></p> <ol><li>封装私有变量</li> <li>模仿块级作用域(ES5中没有块级作用域)</li> <li>实现JS的模块</li></ol> <p>闭包是指有权访问另一个函数作用域中的变量的函数，创建闭包最常用的方式就是在一个函数内部创建另一个函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">maker</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> x <span class="token operator">+</span> y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> add1 <span class="token operator">=</span> <span class="token function">maker</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> add2 <span class="token operator">=</span> <span class="token function">maker</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">add1</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 15</span>
<span class="token function">add2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 20</span>
</code></pre></div><p>一个匿名函数声明在了 <code>func</code> 中，并在执行前被 <code>func</code> 返回。这个函数中使用到了 <code>maker</code> 函数接收的 <code>x</code> ，并返回 <code>x + y</code> 这个表达式的结果。</p> <p><code>add1</code> 和 <code>add2</code> 都是闭包，调用了 <code>maker</code> 函数之后，他们自己就变成了一个函数，这个函数保留了之前的词法环境（ <code>add1</code> 和 <code>add2</code> 中 <code>x</code> 的值都是 <code>10</code> ），接收一个 <code>y</code> 作为参数，并和 <code>x</code> 进行计算，最后返回结果。</p> <p>正常来说，当 <code>maker</code> 执行完毕后，<code>maker</code> 中的那个匿名函数的作用域是会被销毁的，包括里面的变量引用，但是事实证明并没有，这个函数还是持有该作用域的引用，这个引用就是闭包。</p> <h3 id="模块模式"><a href="#模块模式" class="header-anchor">#</a> 模块模式</h3> <p>闭包还有一个用途：定义公共函数，并令其可以访问私有函数和变量，也称为<strong>模块模式</strong>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">api</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        num <span class="token operator">+=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span><span class="token punctuation">{</span>
        <span class="token function-variable function">add</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> num<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">del</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> num<span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">val</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> num<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token function">api</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
</code></pre></div><blockquote><p>私有方法不仅仅有利于限制对代码的访问：还提供了管理全局命名空间的强大能力，避免非核心的方法弄乱了代码的公共接口部分。</p></blockquote> <h3 id="经典面试题"><a href="#经典面试题" class="header-anchor">#</a> 经典面试题</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>对于上面的代码，乍一看循环打出 <code>i</code> 的值，不就是12345...吗。</p> <p>而结果却是打印出 <code>10</code> 次 <code>11</code> 。</p> <p>这是因为 <code>setTimeout</code> 是异步操作（同步优先于异步优先于回调）， <code>for</code> 循环是同步事件会先执行完毕，紧接着执行事件队列中的 <code>setTimeout</code> 回调。</p> <p>变量 <code>i</code> 是使用 <code>var</code> 定义的，是函数级的作用域，不属于 <code>for</code> 循环体，等循环结束后，i已经等于 <code>11</code> ，此时再执行 <code>setTimeout</code> 的回调，打印i时向上查找作用域，找到的 <code>i</code> 的值都是 <code>11</code> ，所以打印出来都是 <code>11</code> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>而使用闭包则可以解决这个问题，原因是闭包可以形成一个私有的作用域， <code>i</code> 的值可以被保存，每轮循环都会将新的 <code>i</code> 的值作为参数传入闭包中，保证输出的正确。</p> <h3 id="性能"><a href="#性能" class="header-anchor">#</a> 性能</h3> <p>闭包的功能是强大的，但是使用它也是有代价的。由于闭包中的作用域一直存在，所以不会被 <code>JavaScript</code> 回收，而闭包中的变量则会一直占用着内存，会增加内存的开销，而且如果使用不当会造成内存泄漏。</p> <h2 id="垃圾回收"><a href="#垃圾回收" class="header-anchor">#</a> 垃圾回收</h2> <h3 id="概念-2"><a href="#概念-2" class="header-anchor">#</a> 概念</h3> <div class="tip custom-block"><p class="custom-block-title">JavaScript权威指南</p> <p>由于字符串、对象和数组没有固定大小，所有当他们的大小已知时，才能对他们进行动态的存储分配。JavaScript程序每次创建字符串、数组或对象时，解释器都必须分配内存来存储那个实体。只要像这样动态地分配了内存，最终都要释放这些内存以便他们能够被再用，否则，JavaScript的解释器将会消耗完系统中所有可用的内存，造成系统崩溃。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a <span class="token punctuation">;</span> <span class="token comment">//重写 b</span>
<span class="token operator">...</span>
</code></pre></div><p>比如说上面的代码，将变量 <code>b</code> 重新进行赋值时拷贝了变量 <code>a</code> 的值，变量 <code>b</code> 的原本的那个值 <code>999</code> 此时还在栈中，只不过没有变量引用它，这个时候 <code>JavaScript</code> 检测到它是没有被引用的，判定它不再被需要，便会回收它，将内存释放出来。</p> <h3 id="垃圾回收机制"><a href="#垃圾回收机制" class="header-anchor">#</a> 垃圾回收机制</h3> <ol><li>标记清除</li></ol> <p>首先，垃圾回收器获取根，并进行<strong>标记</strong>，然后访问所有来自它们的引用并标记，以此类推，直到有<strong>未访问</strong>的引用为止。最后，清除未被标记的对象。</p> <ol start="2"><li>引用计数</li></ol> <p>语言引擎中有一张表，用于存放内存中的值被引用的次数，如果一个值的引用次数为0，就表示这个值不会被用到，就会被回收。</p> <p>同理，如果一个值不再被需要，但引用次数却不为0，<code>JavaScript</code> 不会回收这个变量。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
</code></pre></div><p><code>[1,2,3,4,5]</code> 这个值保存在内存中，变量arr则为它的引用，所以引用次数为1，所以尽管之后的代码中并没有使用到 <code>arr</code> 这个变量，但 <code>JavaScript</code> 并不会回收这个 <code>arr</code> 。</p> <p>想要让 <code>JavaScript</code> 回收这个值，你可以将手动将 <code>arr</code> 的引用指向空。</p> <div class="language-js extra-class"><pre class="language-js"><code>arr <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="内存泄露"><a href="#内存泄露" class="header-anchor">#</a> 内存泄露</h3> <p>当内存中的一个值已经不再被需要，但是由于某些原因 <code>JavaScript</code> 没有将其回收，这个没有作用的的值就一直占据着内存，这种情况称为<strong>内存泄露</strong>。</p> <ol><li>全局变量</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  name <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>name</code> 没有使用 <code>var</code> 或是 <code>let</code> 、 <code>const</code> 声明，此时会挂载在 <code>window</code> 上，而在全局作用域中调用 <code>foo</code> 函数， <code>this</code> 同样指向 <code>window</code> ，所以声明的这两个变量在页面关闭之前不会变变量回收。</p> <ol start="2"><li>闭包</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">,</span>age <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> age:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>计时器和回调函数</li></ol> <p>当不需要定时器的时候没有清除定时器，定时器中的回调函数以及变量都无法被回收。</p> <p><code>setinterval</code> 和 <code>settimeout</code> 创建的定时器函数，只有随着窗口的关闭才会被自动关闭，所以在不使用的时候要记得手动进行关闭。</p> <p>对应的销毁定时器函数： <code>clearInterval</code> 、 <code>clearTimeout</code> 。</p> <ol start="4"><li>DOM引用</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>button</code> 这个变量引用了按钮 <code>DOM</code> ，所以即便用 <code>removeChild</code> 移除了 <code>DOM</code> ， <code>button</code> 变量中仍然存在着对这个 <code>DOM</code> 的引用。</p> <h3 id="常见的处理方法"><a href="#常见的处理方法" class="header-anchor">#</a> 常见的处理方法</h3> <ul><li>优先使用ES6语法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 错误</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  name <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 正确</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'xgq'</span><span class="token punctuation">;</span> <span class="token comment">// 不要省略 var 等声明变量的语法</span>
  <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span> <span class="token comment">// 全局变量作用域中不使用 this，避免创建全局变量</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>ES6</strong> 引入了 <code>let</code> 、 <code>const</code> ，尽量用这些语法来代替 <code>var</code> 声明。</p> <ul><li>清空数组</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// arr = []; // 错误</span>
arr<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 正确</span>
</code></pre></div><p>清空数组，很多人可能会使用 <code>arr=[]</code> 重新进行赋值，但这样其实并没有清除掉数组，反而创建了一个新的空数组，原来的那个数组对象就变成了内存垃圾。</p> <p>正确的做法是直接让数组的长度赋值为0，既能达到清空数组的目的，又能实现数组的复用。</p> <ul><li>复用对象</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 错误</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">999</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span>i <span class="token operator">=</span> i<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 正确</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">999</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  obj<span class="token punctuation">.</span>i <span class="token operator">=</span> i<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>每次循环都创建一个新的对象，对内存来说是一个很大的开支，当对象无法短时间内被垃圾回收时，会造成性能上的浪费，而这些是没必要的开支。</p> <h2 id="this"><a href="#this" class="header-anchor">#</a> this</h2> <h3 id="概念-3"><a href="#概念-3" class="header-anchor">#</a> 概念</h3> <p><code>this</code> 指向是 <code>JavaScript</code> 中很重要的一个知识点。了解 <code>this</code> 的指向可以在写代码时避免很多莫名其妙的引用错误。</p> <blockquote><p>在ES5中，this永远指向最后调用它的对象所在的作用域</p></blockquote> <ul><li>全局调用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window-xgq'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'a-xgq'</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window-xgq</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window-xgq</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>用代码来理解一下上面这句话。</p> <p>这里提一个知识点，非严格模式下，在全局作用域中使用 <code>var</code> 来声明变量，变量会被挂载到 <code>window</code> 上，所以此时声明的变量 <code>name</code> 在 <code>window</code> 中（window.name）。</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>在代码的头部写上 <strong>'use strict'</strong> ，可以进入严格模式。</p></div> <p>首先执行全局的那个打印，全局作用域中调用的打印，this肯定是指向 <code>window</code> 的，所以 <code>this.name</code> 就是去 <code>window</code> 中找 <code>name</code> 这个变量。</p> <p>第二次打印，是在函数a中，this指向哪呢？this指向最后调用它的对象所在的作用域，我们是在全局作用域中调用这个函数a的，所以它也同样指向全局作用域，同样是去 <code>window</code> 中找 <code>name</code> 。</p> <ul><li>对象中调用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window-xgq'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span><span class="token string">'obj-xgq'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj-xgq</span>
</code></pre></div><p>我们看直接打印语句，这个打印在函数 <code>foo</code> 中，我们只需要看是谁最后调用的 <code>foo</code> 的就行。</p> <p><code>obj.foo()</code> 说明是这个 <code>obj</code> 对象最后调用了它，所以 <code>this</code> 就指向 <code>obj</code> ，找 <code>name</code> 也就在 <code>obj</code> 里找，找到的也就是 <code>obj</code> 中的 <code>name</code> ：obj-xgq。</p> <ul><li>new</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window-xgq'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>用 <code>new</code> 关键字进行调用，<code>this</code> 会被永远的绑定在构造函数的实例 <code>test</code> 中，且不会被任何方式改变，这里 <code>this</code> 被绑定在了 <code>test</code> 里，所以在 <code>test</code> 里找不到 <code>name</code> 。</p> <h3 id="箭头函数"><a href="#箭头函数" class="header-anchor">#</a> 箭头函数</h3> <p>ES6中，引入了箭头函数，箭头函数中的 <code>this</code> 的指向与普通函数有所区别。</p> <blockquote><p>箭头函数的 <code>this</code> 始终指向函数定义时的 <code>this</code> ，而非执行时。</p></blockquote> <div class="tip custom-block"><p class="custom-block-title">注意</p> <p>箭头函数中没有 <code>this</code> 绑定，必须通过查找作用域链来决定其值，如果箭头函数被非箭头函数包含，则 <code>this</code> 绑定的是最近一层非箭头函数的 <code>this</code> ，否则，<code>this</code> 为 <code>undefined</code> 。</p></div> <p>也就是说箭头函数其实是没有 <code>this</code> 的，它的 <code>this</code> 取决于包裹着它的那个普通函数的 <code>this</code> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window-xgq'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span><span class="token string">'obj-xgq'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">inner</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">arrow</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj-xgq</span>
obj<span class="token punctuation">.</span><span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj-xgq</span>
obj<span class="token punctuation">.</span><span class="token function">arrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window-xgq</span>
</code></pre></div><p><code>inner</code> 函数包裹了一个自执行的箭头函数，可以看到它的 <code>this</code> 是就是包裹着它的 <code>inner</code> 函数的 <code>this</code> ，所以指向的是 <code>obj</code> 对象的作用域，读到的 <code>name</code> 就是 <code>obj</code> 里的 <code>name</code> 。</p> <p>而 <code>arrow</code> 这个箭头函数，虽然声明在对象里，但是外面没有普通的函数包裹它，所以直接就是全局作用域：<code>window</code> 。</p> <h3 id="优先级"><a href="#优先级" class="header-anchor">#</a> 优先级</h3> <p>安照优先级进行排序</p> <ol><li><code>new</code> 的优先级最高</li> <li>其次是 <code>call、bind、apply</code></li> <li>然后是 <code>obj.foo()</code> 这种调用方法</li> <li>最后是普通函数调用</li></ol> <h2 id="apply、​call、bind"><a href="#apply、​call、bind" class="header-anchor">#</a> apply、​call、bind</h2> <p>通过使用 <code>apply</code>、<code>​call</code>、<code>bind</code> ，我们可以改变 <code>this</code> 的指向。</p> <h3 id="apply"><a href="#apply" class="header-anchor">#</a> apply</h3> <p><strong>apply()</strong> 方法调用一个具有给定 <code>this</code> 值的函数，以及作为一个数组（或类似数组对象）提供的参数。</p> <div class="tip custom-block"><p class="custom-block-title">语法</p> <p>func.apply(thisArg, [argsArray])</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'xgq'</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">'obj'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">a</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// arguments 是一个对应于传递给函数的参数的类数组对象</span>
<span class="token punctuation">}</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// xgq undefined</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">321</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj 123</span>
</code></pre></div><p>直接执行函数a，是在全局作用域中。而使用 <code>apply</code> 函数可以改变函数执行时 <code>this</code> 的指向，将 <code>this</code> 指向绑定到 <code>obj</code> 这个对象。</p> <h3 id="call"><a href="#call" class="header-anchor">#</a> call</h3> <p><strong>call()</strong> 方法使用一个指定的 <code>this</code> 值和单独给出的一个或多个参数来调用一个函数。</p> <div class="tip custom-block"><p class="custom-block-title">语法</p> <p>function.call(thisArg, arg1, arg2, ...)</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'xgq'</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">'obj'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">a</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// xgq undefined</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">321</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj [123,321]</span>
</code></pre></div><p><code>call</code> 的用法和 <code>apply</code> 相似。</p> <h3 id="bind"><a href="#bind" class="header-anchor">#</a> bind</h3> <p><strong>bind()</strong> 方法创建一个新的函数，在 <strong>bind()</strong> 被调用时，这个新函数的 <code>this</code> 被指定为 <strong>bind()</strong> 的第一个参数，而其余参数将作为新函数的参数，供调用时使用。</p> <div class="tip custom-block"><p class="custom-block-title">语法</p> <p>function.bind(thisArg[, arg1[, arg2[, ...]]])</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'xgq'</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">'obj'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">a</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// xgq undefined</span>
<span class="token function">a</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">321</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// obj [123,321]</span>
</code></pre></div><p><code>bind</code> 同样可以完成 <code>this</code> 指向的变更。</p> <h3 id="apply、​call、bind的区别"><a href="#apply、​call、bind的区别" class="header-anchor">#</a> apply、​call、bind的区别</h3> <ul><li>apply 和 call</li></ul> <p><code>apply</code> 和 <code>call</code> 的用法相似，不同之处在于 <code>apply</code> 接收的是一个数组，数组中包含多个参数；而 <code>call</code> 则是直接接收若干个参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">func</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>bind</li></ul> <p>而 <code>bind</code> 则与 <code>apply</code> 和 <code>call</code> 不同，<code>bind</code> 不会马上调用这个函数，而是返回一个新的函数，需要手动执行这个新的函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">func</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="​generator"><a href="#​generator" class="header-anchor">#</a> ​Generator</h2> <p>待补充</p> <h2 id="promise"><a href="#promise" class="header-anchor">#</a> Promise</h2> <p>待补充</p> <h2 id="async、await"><a href="#async、await" class="header-anchor">#</a> async、await</h2> <p>待补充</p> <h2 id="定时器"><a href="#定时器" class="header-anchor">#</a> 定时器</h2> <p>待补充</p> <h2 id="ajax"><a href="#ajax" class="header-anchor">#</a> ajax</h2> <div class="tip custom-block"><p class="custom-block-title">MDN</p> <p>AJAX是异步的JavaScript和XML（Asynchronous JavaScript And XML）。简单点说，就是使用 XMLHttpRequest 对象与服务器通信。 它可以使用JSON，XML，HTML和text文本等格式发送和接收数据。AJAX最吸引人的就是它的“异步”特性，也就是说他可以在不重新刷新页面的情况下与服务器通信，交换数据，或更新页面。</p></div> <h3 id="jquery"><a href="#jquery" class="header-anchor">#</a> jQuery</h3> <div class="language-js extra-class"><pre class="language-js"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'http://localhost/time.php'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'接收到数据'</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>用过 <code>jquery</code> 的都知道，使用 <code>ajax</code> 来进行 <code>http</code> 请求，与后端进行交互，获取数据。</p> <p>而 <code>ajax</code> 就是使用 <code>XMLHttpRequest</code> 来实现的。</p> <h3 id="xmlhttprequest"><a href="#xmlhttprequest" class="header-anchor">#</a> XMLHttpRequest</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//服务端响应的文本</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">&quot;http://localhost/api.php&quot;</span><span class="token punctuation">;</span><span class="token comment">//请求地址</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>运行到代码的最后一行，执行 <code>send</code> 函数，这个 <code>http</code> 请求会发起，当服务器响应时，会调用 <code>onreadystatechange</code> 函数，通过判断响应值，我们就能知道这次请求是否成功。</p> <ul><li><strong>readyState</strong></li></ul> <p><code>XMLHttpRequest.readyState</code> 返回一个 <code>XMLHttpRequest</code>  代理当前所处的状态。</p> <table><thead><tr><th style="text-align:left">值</th> <th style="text-align:center">状态</th> <th style="text-align:right">描述</th></tr></thead> <tbody><tr><td style="text-align:left">0</td> <td style="text-align:center">UNSENT</td> <td style="text-align:right">代理被创建，但尚未调用 open() 方法。</td></tr> <tr><td style="text-align:left">1</td> <td style="text-align:center">OPENED</td> <td style="text-align:right">open() 方法已经被调用。</td></tr> <tr><td style="text-align:left">2</td> <td style="text-align:center">HEADERS_RECEIVED</td> <td style="text-align:right">send() 方法已经被调用，并且头部和状态已经可获得。</td></tr> <tr><td style="text-align:left">3</td> <td style="text-align:center">LOADING</td> <td style="text-align:right">下载中； responseText 属性已经包含部分数据。</td></tr> <tr><td style="text-align:left">4</td> <td style="text-align:center">DONE</td> <td style="text-align:right">下载操作已完成。</td></tr></tbody></table> <ul><li><strong>status</strong></li></ul> <p><code>XMLHttpRequest.status</code> 返回一个 <code>http</code> 状态码， <code>http</code> 响应状态代码指示特定 <code>http</code> 请求是否已成功完成。</p> <p>状态码主要分为五类：</p> <ul><li>信息响应：100 – 199</li> <li>成功响应：200 – 299</li> <li>重定向：300 – 399</li> <li>客户端错误：400 – 499</li> <li>服务器错误：500 – 599</li></ul> <p><code>http</code> 状态码很多，具体可以查阅：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status" target="_blank" rel="noopener noreferrer">HTTP 响应代码 —— MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="实现ajax"><a href="#实现ajax" class="header-anchor">#</a> 实现ajax</h3> <p>我们试着写一个最简易的 <code>get</code> 请求版 <code>ajax</code> 。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token punctuation">{</span>url<span class="token punctuation">,</span>success<span class="token punctuation">,</span>error<span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
  <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        success <span class="token operator">&amp;&amp;</span> <span class="token function">success</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        error <span class="token operator">&amp;&amp;</span> <span class="token function">error</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">,</span>xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>首先它接收一个对象，这个对象中有一个 <code>url</code> 属性和两个重要的函数。然后我们使用 <code>XMLHttpRequest</code> 进行网络请求，并根据结果执行回调函数。</p> <p>然后就可以像使用 <code>$.ajax</code> 一样使用了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span><span class="token string">'http://localhost/api.php'</span><span class="token punctuation">,</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据'</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'错误码'</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="es6"><a href="#es6" class="header-anchor">#</a> ES6</h2> <h3 id="var、let、const的区别"><a href="#var、let、const的区别" class="header-anchor">#</a> var、let、const的区别</h3></div></div></div> <div class="column no-pad-r sm-25 xl-33 xsNone smNone post-sidebar"><div class="bizu box-default post-sidebar__bizu bizu--vertical"><div class="bizu-image"><span class="bizu-close">×</span> <a href="https://www.vultr.com/?ref=8407544-6G" target="_blank" rel="nofollow noopener"><img src="https://www.vultr.com/media/banners/banner_300x250.png" alt="vultr" class="bizu-image__image"></a></div> <div class="bizu-info"><a href="https://www.vultr.com/?ref=8407544-6G" target="_blank" rel="nofollow noopener" class="bizu-info__link bizu-info__text">
      Vultr 高性能云服务器 VPS 重磅限时优惠：新用户充10送100美元
    </a> <a href="https://www.vultr.com/?ref=7523115" target="_blank" rel="nofollow noopener" class="bizu-info__link bizu-info__by">
      vultr.com
    </a></div></div></div> <aside class="column xs-100"><hr class="divider"> <div><div class="observer"><!----> <!----> <!----></div></div> <hr class="divider"> <section class="post-content__disqus"><h3>发表一下意见吧</h3> <!----></section></aside></div></section></article></div> <!----> <aside class="container main"></aside></div> <!----> <div class="elevator"><a class="elevator__link"><span class="icon elevator__icon">greaterthan</span></a></div> <!----></div></main> <footer class="footer"><div class="footer-box1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 161" class="footer-box__shape"><path d="M-11.925-4809v-154.746c40.454,19.75,273.683,130.936,420.544,142.612,161.25,12.821,339.978-42.709,521.543-86.3,169.82-40.769,395.43,29.2,423.912,38.429v60Z" transform="translate(11.926 4970)"></path></svg></div> <div class="footer-box2"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1366 246" class="footer-box__shape"><path d="M-1505.5-4725.5v-238.1c8.149-3.133,18.138-5.059,29.672-5.9h30.954c201.21,11.667,696.6,224.535,855.572,236.458,205.129,15.385,287.179-164.1,432.047-175.625a42.381,42.381,0,0,1,16.756,1.857V-4725.5Z" transform="translate(1506 4971)"></path></svg> <ul class="footer-social__list"><li class="footer-social__item"><a href="https://www.twitter.com/xuguanqun" target="_blank" rel="noopener external" title="Follow us on Facebook"><span class="icon footer-social__icon">twitter</span></a></li><li class="footer-social__item"><a href="https://www.github.com/xuguanqun" target="_blank" rel="noopener external" title="Follow us on Facebook"><span class="icon footer-social__icon">github</span></a></li></ul> <div class="footer-newsletter"><!----></div></div> <section class="footer-box3"><div class="row"><div class="column sm-50 footer-card"><div class="observer"><div class="spinner observer__spinner"><div class="double-bounce1"></div> <div class="double-bounce2"></div></div> <!----> <!----></div></div> <div class="column sm-50 footer-nav"><div class="row justify-right"><div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--1"><h2 class="meta-text title">博客</h2> <nav class="footer-nav1"><ul><li class="footer-nav1__item"><a href="/about/">关于</a> <!----></li><li class="footer-nav1__item"><a href="/categories/">类别</a> <!----></li></ul></nav></div> <div class="column xs-50 sm-40 md-33 footer-nav__box footer-nav__box--2"><h2 class="meta-text title">社区</h2> <nav class="footer-nav2"><ul><li class="footer-nav2__item"><!----> <a href="https://blog.csdn.net/weixin_44488811" rel="noopener nofollow" target="_blank">CSDN</a></li><li class="footer-nav2__item"><!----> <a href="https://juejin.im/user/5bfb70dfe51d454ac11c5647" rel="noopener nofollow" target="_blank">掘金</a></li></ul></nav></div></div></div> <div class="column sm-100 footer-copy">2019 © xuguanqun - 
        <a href="https://xuguanqun.github.io/" rel="noopener" target="_blank">
          github
        </a></div></div> <span class="shapes shapes--circle" style="left: 3%; top: -20%"></span> <span class="shapes shapes--primary shapes--color3" style="left: 30%; top: -15%"></span> <span class="shapes shapes--primary" style="left: 13%; top: -80%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle shapes--color4" style="left: 40%; top: 200px"></span> <span class="shapes shapes--primary" style="left: 15%; bottom: 10%; transform: rotate(75deg)"></span> <span class="shapes shapes--circle shapes--color3" style="right: 50%; top: 30%"></span> <span class="shapes shapes--primary" style="right: 20%; top: -100%"></span> <span class="shapes shapes--circle" style="right: 10%; top: -20%"></span> <span class="shapes shapes--color4" style="right: 35%; top: -20%; transform: rotate(45deg)"></span> <span class="shapes shapes--circle" style="left: 40%; top: -50%"></span> <span class="shapes shapes--color3" style="right: 30%; top: 20%"></span> <span class="shapes shapes--circle shapes--primary" style="right: 30%; bottom: 20%"></span></section></footer></div> <!----> <!----></div></div>
    <script src="/assets/js/app.4e01488e.js" defer></script><script src="/assets/js/13.06b288ed.js" defer></script><script src="/assets/js/3.be68ce54.js" defer></script><script src="/assets/js/12.a2cf6586.js" defer></script><script src="/assets/js/11.b23c35cd.js" defer></script><script src="/assets/js/16.cc0be713.js" defer></script><script src="/assets/js/2.13afa1ee.js" defer></script><script src="/assets/js/5.0b9f2628.js" defer></script><script src="/assets/js/17.448d70ea.js" defer></script><script src="/assets/js/9.e77f29c9.js" defer></script><script src="/assets/js/7.960e42a4.js" defer></script><script src="/assets/js/6.f8153584.js" defer></script><script src="/assets/js/10.99ce920a.js" defer></script><script src="/assets/js/14.6e26b32d.js" defer></script><script src="/assets/js/4.3b6e6970.js" defer></script>
  </body>
</html>
